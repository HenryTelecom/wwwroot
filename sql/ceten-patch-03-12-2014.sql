CREATE TABLE members (id INT AUTO_INCREMENT NOT NULL, firstname VARCHAR(100) NOT NULL, lastname VARCHAR(100) NOT NULL, year INT NOT NULL, payment INT NOT NULL, deposit TINYINT(1) NOT NULL, depositName VARCHAR(200) DEFAULT NULL, welcomePack TINYINT(1) NOT NULL, mailing TINYINT(1) NOT NULL, email VARCHAR(255) NOT NULL, PRIMARY KEY(id)) DEFAULT CHARACTER SET utf8 COLLATE utf8_unicode_ci ENGINE = InnoDB;
CREATE TABLE products (id INT AUTO_INCREMENT NOT NULL, name VARCHAR(100) NOT NULL, slug VARCHAR(100) NOT NULL, description LONGTEXT NOT NULL, price DOUBLE PRECISION NOT NULL, cetenPrice DOUBLE PRECISION NOT NULL, image VARCHAR(255) NOT NULL, updated DATETIME NOT NULL, homepage TINYINT(1) NOT NULL, stock INT NOT NULL, UNIQUE INDEX product_unique_idx (slug), PRIMARY KEY(id)) DEFAULT CHARACTER SET utf8 COLLATE utf8_unicode_ci ENGINE = InnoDB;
CREATE TABLE products_tags (product_id INT NOT NULL, tag_id INT NOT NULL, INDEX IDX_E3AB5A2C4584665A (product_id), INDEX IDX_E3AB5A2CBAD26311 (tag_id), PRIMARY KEY(product_id, tag_id)) DEFAULT CHARACTER SET utf8 COLLATE utf8_unicode_ci ENGINE = InnoDB;
CREATE TABLE products_orders (id INT AUTO_INCREMENT NOT NULL, product_id INT NOT NULL, order_id INT NOT NULL, count INT NOT NULL, INDEX IDX_631C76C44584665A (product_id), INDEX IDX_631C76C48D9F6D38 (order_id), PRIMARY KEY(id)) DEFAULT CHARACTER SET utf8 COLLATE utf8_unicode_ci ENGINE = InnoDB;
CREATE TABLE sessions (id INT AUTO_INCREMENT NOT NULL, user_id INT DEFAULT NULL, name VARCHAR(40) NOT NULL, INDEX IDX_9A609D13A76ED395 (user_id), UNIQUE INDEX session_unique_idx (name), PRIMARY KEY(id)) DEFAULT CHARACTER SET utf8 COLLATE utf8_unicode_ci ENGINE = InnoDB;
CREATE TABLE shop_orders (id INT AUTO_INCREMENT NOT NULL, user_id INT NOT NULL, payment INT DEFAULT 0 NOT NULL, state INT DEFAULT 0 NOT NULL, created DATETIME NOT NULL, total DOUBLE PRECISION NOT NULL, INDEX IDX_608DDB6CA76ED395 (user_id), PRIMARY KEY(id)) DEFAULT CHARACTER SET utf8 COLLATE utf8_unicode_ci ENGINE = InnoDB;
CREATE TABLE tags (id INT AUTO_INCREMENT NOT NULL, name VARCHAR(100) NOT NULL, slug VARCHAR(100) NOT NULL, position INT NOT NULL, UNIQUE INDEX tag_unique_idx (slug), PRIMARY KEY(id)) DEFAULT CHARACTER SET utf8 COLLATE utf8_unicode_ci ENGINE = InnoDB;
CREATE TABLE users (id INT AUTO_INCREMENT NOT NULL, username VARCHAR(255) NOT NULL, password VARCHAR(255) DEFAULT NULL, salt VARCHAR(255) DEFAULT NULL, roles LONGTEXT NOT NULL COMMENT '(DC2Type:simple_array)', firstname VARCHAR(255) DEFAULT NULL, lastname VARCHAR(255) DEFAULT NULL, enabled TINYINT(1) NOT NULL, oauth TINYINT(1) NOT NULL, ceten TINYINT(1) NOT NULL, UNIQUE INDEX user_username_idx (username), PRIMARY KEY(id)) DEFAULT CHARACTER SET utf8 COLLATE utf8_unicode_ci ENGINE = InnoDB;
ALTER TABLE products_tags ADD CONSTRAINT FK_E3AB5A2C4584665A FOREIGN KEY (product_id) REFERENCES products (id) ON DELETE CASCADE;
ALTER TABLE products_tags ADD CONSTRAINT FK_E3AB5A2CBAD26311 FOREIGN KEY (tag_id) REFERENCES tags (id) ON DELETE CASCADE;
ALTER TABLE products_orders ADD CONSTRAINT FK_631C76C44584665A FOREIGN KEY (product_id) REFERENCES products (id);
ALTER TABLE products_orders ADD CONSTRAINT FK_631C76C48D9F6D38 FOREIGN KEY (order_id) REFERENCES shop_orders (id) ON DELETE CASCADE;
ALTER TABLE sessions ADD CONSTRAINT FK_9A609D13A76ED395 FOREIGN KEY (user_id) REFERENCES users (id);
ALTER TABLE shop_orders ADD CONSTRAINT FK_608DDB6CA76ED395 FOREIGN KEY (user_id) REFERENCES users (id);
